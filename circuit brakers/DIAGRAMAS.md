# ğŸ¨ DIAGRAMAS VISUALES DEL SISTEMA

## 1. Arquitectura General

```
                                    CLIENTE
                                (Navegador/App)
                                      â”‚
                                      â”‚ HTTP/REST
                                      â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                                   â”‚
                    â”‚        API GATEWAY :3000          â”‚
                    â”‚      (Punto de entrada)           â”‚
                    â”‚                                   â”‚
                    â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—   â”‚
                    â”‚  â•‘  PATRONES DE RESILIENCIA  â•‘   â”‚
                    â”‚  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£   â”‚
                    â”‚  â•‘ âš¡ Circuit Breaker        â•‘   â”‚
                    â”‚  â•‘ â±ï¸  Timeout                â•‘   â”‚
                    â”‚  â•‘ ğŸ”„ Retry                  â•‘   â”‚
                    â”‚  â•‘ ğŸ’¡ Fallback               â•‘   â”‚
                    â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
                    â”‚                                   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚              â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                                    â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                      â”‚          â”‚                       â”‚
         â”‚  SERVICIO PEDIDOS    â”‚          â”‚   SERVICIO PAGOS      â”‚
         â”‚      :3001           â”‚          â”‚      :3002            â”‚
         â”‚                      â”‚          â”‚                       â”‚
         â”‚  ğŸ“¦ CatÃ¡logo         â”‚          â”‚  âš ï¸ INESTABLE         â”‚
         â”‚  ğŸ“ Pedidos          â”‚          â”‚                       â”‚
         â”‚  ğŸ“Š Stock            â”‚          â”‚  â€¢ 30% fallos        â”‚
         â”‚                      â”‚          â”‚  â€¢ Latencia alta     â”‚
         â”‚  ğŸ’¾ In-Memory DB     â”‚          â”‚  â€¢ Timeouts          â”‚
         â”‚                      â”‚          â”‚                       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. Flujo de Circuit Breaker - Estados

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MÃQUINA DE ESTADOS                             â”‚
â”‚                      DEL CIRCUIT BREAKER                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                                 â”‚
        â”‚           ESTADO: CERRADO ğŸŸ¢                    â”‚
        â”‚                                                 â”‚
        â”‚  â€¢ Sistema funcionando normalmente              â”‚
        â”‚  â€¢ Todas las llamadas pasan al servicio        â”‚
        â”‚  â€¢ Se monitorean fallos                         â”‚
        â”‚                                                 â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â”‚ CondiciÃ³n:
                           â”‚ Tasa de fallos > 50%
                           â”‚ (en ventana de 10s)
                           â”‚
                           â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                                  â”‚
        â”‚           ESTADO: ABIERTO ğŸ”´                     â”‚
        â”‚                                                  â”‚
        â”‚  â€¢ Servicio considerado caÃ­do                    â”‚
        â”‚  â€¢ NO se hacen llamadas al servicio             â”‚
        â”‚  â€¢ Se ejecuta FALLBACK inmediatamente           â”‚
        â”‚  â€¢ Respuesta: < 10ms                            â”‚
        â”‚  â€¢ Ahorra recursos                              â”‚
        â”‚                                                  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â”‚ DespuÃ©s de:
                           â”‚ 5 segundos (resetTimeout)
                           â”‚
                           â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                                  â”‚
        â”‚        ESTADO: SEMI-ABIERTO ğŸŸ¡                   â”‚
        â”‚                                                  â”‚
        â”‚  â€¢ Modo de prueba                               â”‚
        â”‚  â€¢ Se permite 1 llamada al servicio             â”‚
        â”‚  â€¢ Decide si cerrar o reabrir                   â”‚
        â”‚                                                  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                     â”‚
         Request  â”‚                     â”‚  Request
          Ã‰XITO   â”‚                     â”‚  FALLO
                  â”‚                     â”‚
                  â–¼                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  CERRADO ğŸŸ¢  â”‚      â”‚   ABIERTO ğŸ”´    â”‚
        â”‚              â”‚      â”‚                 â”‚
        â”‚ Sistema      â”‚      â”‚ Vuelve a        â”‚
        â”‚ recuperado   â”‚      â”‚ esperar 5s      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. Flujo de Request Exitoso

```
    CLIENTE                  GATEWAY               PEDIDOS           PAGOS
       â”‚                        â”‚                     â”‚               â”‚
       â”‚  POST /pagar           â”‚                     â”‚               â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                     â”‚               â”‚
       â”‚                        â”‚                     â”‚               â”‚
       â”‚                        â”‚  Â¿Circuit Breaker?  â”‚               â”‚
       â”‚                        â”‚  Estado: CERRADO ğŸŸ¢ â”‚               â”‚
       â”‚                        â”‚                     â”‚               â”‚
       â”‚                        â”‚  GET /pedidos/1     â”‚               â”‚
       â”‚                        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚               â”‚
       â”‚                        â”‚                     â”‚               â”‚
       â”‚                        â”‚  {pedido data}      â”‚               â”‚
       â”‚                        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚               â”‚
       â”‚                        â”‚                     â”‚               â”‚
       â”‚                        â”‚  POST /pagos/procesar               â”‚
       â”‚                        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                        â”‚    (Timeout: 2s)    â”‚               â”‚
       â”‚                        â”‚                     â”‚    Procesa    â”‚
       â”‚                        â”‚                     â”‚    (500ms)    â”‚
       â”‚                        â”‚                     â”‚               â”‚
       â”‚                        â”‚  {success, txId}    â”‚               â”‚
       â”‚                        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
       â”‚                        â”‚                     â”‚               â”‚
       â”‚                        â”‚  Circuit Breaker    â”‚               â”‚
       â”‚                        â”‚  Registra: âœ… SUCCESSâ”‚               â”‚
       â”‚                        â”‚                     â”‚               â”‚
       â”‚  200 OK                â”‚                     â”‚               â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                     â”‚               â”‚
       â”‚  {success, txId}       â”‚                     â”‚               â”‚
       â”‚                        â”‚                     â”‚               â”‚

       Tiempo total: ~600ms
```

---

## 4. Flujo con Fallos - Circuit Breaker se Abre

```
    CLIENTE                  GATEWAY                              PAGOS
       â”‚                        â”‚                                   â”‚
       â”‚  [REQUEST 1]           â”‚                                   â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚  Circuit: CERRADO ğŸŸ¢              â”‚
       â”‚                        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                        â”‚                     âŒ 500 ERROR  â”‚
       â”‚                        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
       â”‚  âŒ 500 Error          â”‚  Registra: FAILURE                â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  Tasa fallo: 33%                  â”‚
       â”‚                        â”‚                                   â”‚
       â”‚  [REQUEST 2]           â”‚                                   â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚  Circuit: CERRADO ğŸŸ¢              â”‚
       â”‚                        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
       â”‚                        â”‚                     âŒ 500 ERROR  â”‚
       â”‚                        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
       â”‚  âŒ 500 Error          â”‚  Registra: FAILURE                â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  Tasa fallo: 55% â†’ ABRE CIRCUIT  â”‚
       â”‚                        â”‚  ğŸ”´ CIRCUIT ABIERTO               â”‚
       â”‚                        â”‚                                   â”‚
       â”‚  [REQUEST 3]           â”‚                                   â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚  Circuit: ABIERTO ğŸ”´              â”‚
       â”‚                        â”‚                                   â”‚
       â”‚                        â”‚  âš¡ NO llama al servicio          â”‚
       â”‚                        â”‚  ğŸ’¡ FALLBACK inmediato            â”‚
       â”‚                        â”‚                                   â”‚
       â”‚  202 Accepted          â”‚                                   â”‚
       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                                   â”‚
       â”‚  {fallback: true}      â”‚                                   â”‚
       â”‚  Tiempo: <10ms         â”‚                                   â”‚
       â”‚                        â”‚                                   â”‚

       Ahorro: 2000ms de timeout âœ…
```

---

## 5. ComparaciÃ³n Visual: CON vs SIN Resiliencia

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  SIN PATRONES DE RESILIENCIA                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Cliente â”€â”€> Gateway â”€â”€> Servicio Pagos (CAÃDO)
                            â”‚
                            â”‚ Espera... espera... espera...
                            â”‚ (2000ms - 5000ms)
                            â”‚
                            â–¼
                         âŒ TIMEOUT
                            â”‚
Cliente <â”€â”€ Gateway <â”€â”€â”€â”€â”€â”€â”€â”˜
            âŒ Error 500

Resultado:
â€¢ Tiempo: 2000-5000ms
â€¢ Usuario frustrado
â€¢ Recursos bloqueados
â€¢ Sistema no disponible


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  CON PATRONES DE RESILIENCIA                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Cliente â”€â”€> Gateway â”€â”€> Circuit Breaker (ABIERTO ğŸ”´)
                            â”‚
                            â”‚ Detecta: Servicio caÃ­do
                            â”‚ NO llama al servicio
                            â”‚
                            â–¼
                         ğŸ’¡ FALLBACK
                            â”‚
Cliente <â”€â”€ Gateway <â”€â”€â”€â”€â”€â”€â”€â”˜ (<10ms)
            202 Accepted
            "SerÃ¡ procesado mÃ¡s tarde"

Resultado:
â€¢ Tiempo: <10ms
â€¢ Usuario informado
â€¢ Recursos liberados
â€¢ Sistema disponible
```

---

## 6. LÃ­nea de Tiempo de RecuperaciÃ³n

```
0s                5s               10s              15s             20s
â”‚                 â”‚                â”‚                â”‚                â”‚
â”‚   ğŸ”´ ABIERTO    â”‚   ğŸŸ¡ PRUEBA    â”‚   ğŸŸ¢ CERRADO   â”‚   ğŸŸ¢ NORMAL    â”‚
â”‚                 â”‚                â”‚                â”‚                â”‚
â”‚  Muchos fallos  â”‚  Espera 5s     â”‚  Request OK    â”‚  Funcionando   â”‚
â”‚  Circuit abre   â”‚  Intenta 1     â”‚  Circuit       â”‚  normalmente   â”‚
â”‚                 â”‚  request       â”‚  cierra        â”‚                â”‚
â”‚                 â”‚                â”‚                â”‚                â”‚
â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼

Requests rechazados     Prueba          TrÃ¡fico normal reanudado
(Fallback inmediato)    recuperaciÃ³n
```

---

## 7. DistribuciÃ³n de Fallos (Servicio de Pagos)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     PROBABILIDAD DE RESPUESTA               â”‚
â”‚     (Servicio de Pagos)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    100% â”‚
         â”‚
     70% â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â† 70% Ã‰XITO âœ…
         â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
         â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
         â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
     30% â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â† 30% FALLO âŒ
         â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
         â”‚
      0% â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
              Requests


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     DISTRIBUCIÃ“N DE LATENCIA                â”‚
â”‚     (Servicio de Pagos)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    3000ms â”‚                    â–ˆ
           â”‚              â–ˆ     â–ˆ
           â”‚         â–ˆ    â–ˆ     â–ˆ
           â”‚    â–ˆ    â–ˆ    â–ˆ     â–ˆ
    1500ms â”‚    â–ˆ    â–ˆ    â–ˆ     â–ˆ
           â”‚    â–ˆ    â–ˆ    â–ˆ     â–ˆ
           â”‚ â–ˆ  â–ˆ    â–ˆ    â–ˆ     â–ˆ
           â”‚ â–ˆ  â–ˆ    â–ˆ    â–ˆ     â–ˆ
     200ms â”‚ â–ˆ  â–ˆ    â–ˆ    â–ˆ     â–ˆ  â–ˆ
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            Min      P50      Max
          200ms    1100ms   3000ms
```

---

## 8. Flujo de Datos Completo

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   FLUJO E2E: CREAR Y PAGAR PEDIDO                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1ï¸âƒ£ Consultar Productos
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    GET /api/productos     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ CLIENTEâ”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚ GATEWAY â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚           Lista productos          â”‚
        â”‚         (Con RETRY ğŸ”„)             â”‚
        â”‚                                    â–¼
        â”‚                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                            â”‚   PEDIDOS   â”‚
        â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â–¼

2ï¸âƒ£ Crear Pedido
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   POST /api/pedidos      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ CLIENTEâ”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚ GATEWAY â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚        {items, cliente}            â”‚
        â”‚         (Con RETRY ğŸ”„)             â”‚
        â”‚                                    â–¼
        â”‚                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                            â”‚   PEDIDOS   â”‚
        â”‚                            â”‚  Crea PED-1 â”‚
        â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚       Retorna: {id: PED-1}
        â–¼

3ï¸âƒ£ Procesar Pago (CON RESILIENCIA ğŸ›¡ï¸)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  POST /api/pedidos/PED-1/pagar  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ CLIENTEâ”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚ GATEWAY â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                            â”‚
        â”‚                                            â–¼
        â”‚                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                    â”‚ Circuit       â”‚
        â”‚                                    â”‚ Breaker       â”‚
        â”‚                                    â”‚ Verifica      â”‚
        â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                            â”‚
        â”‚                                   Â¿Estado? â”‚
        â”‚                                            â”‚
        â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                    â”‚                       â”‚                â”‚
        â”‚                CERRADO ğŸŸ¢              ABIERTO ğŸ”´       SEMI ğŸŸ¡
        â”‚                    â”‚                       â”‚                â”‚
        â”‚                    â–¼                       â–¼                â”‚
        â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
        â”‚            â”‚   PAGOS     â”‚         â”‚  FALLBACK  â”‚          â”‚
        â”‚            â”‚  Procesa    â”‚         â”‚  Inmediato â”‚          â”‚
        â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
        â”‚                    â”‚                       â”‚                â”‚
        â”‚                    â–¼                       â–¼                â”‚
        â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
        â”‚            â”‚ âœ… Success  â”‚         â”‚ ğŸ’¡ Fallbackâ”‚          â”‚
        â”‚            â”‚ o âŒ Error  â”‚         â”‚  Response  â”‚          â”‚
        â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
        â”‚                    â”‚                       â”‚                â”‚
        â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
        â”‚                                â”‚                            â”‚
        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
        â”‚           Respuesta final
        â–¼
```

---

## 9. MÃ©tricas en Tiempo Real

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              DASHBOARD DEL CIRCUIT BREAKER               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Estado Actual: ğŸŸ¢ CERRADO

EstadÃ­sticas (Ãºltimos 10 segundos):
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  Total Requests:       100  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â•‘
â•‘  Exitosos:              70  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  (70%)   â•‘
â•‘  Fallidos:              30  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  (30%)               â•‘
â•‘  Timeouts:               5  â–ˆâ–ˆ  (5%)                      â•‘
â•‘  Fallbacks Activados:   15  â–ˆâ–ˆâ–ˆâ–ˆ  (15%)                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Latencia:
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  Promedio:    850ms                                       â•‘
â•‘  P50 (mediana): 500ms                                     â•‘
â•‘  P95:         1800ms                                      â•‘
â•‘  P99:         2000ms                                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Historial de Estado:
  0s   5s   10s  15s  20s  25s  30s
  ğŸŸ¢ â†’ ğŸ”´ â†’ ğŸŸ¡ â†’ ğŸŸ¢ â†’ ğŸŸ¢ â†’ ğŸŸ¢ â†’ ğŸŸ¢
```

---

## 10. Arquitectura en Capas

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CAPA DE PRESENTACIÃ“N                     â”‚
â”‚                    (Cliente / Frontend)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ HTTP/REST
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  CAPA DE RESILIENCIA                        â”‚
â”‚                     (API Gateway)                           â”‚
â”‚                                                             â”‚
â”‚  ğŸ›¡ï¸ ProtecciÃ³n:                                            â”‚
â”‚  â€¢ Circuit Breaker â†’ Previene cascada                      â”‚
â”‚  â€¢ Timeout â†’ Libera recursos                               â”‚
â”‚  â€¢ Retry â†’ Maneja fallos transitorios                      â”‚
â”‚  â€¢ Fallback â†’ Mantiene disponibilidad                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ HTTP/REST
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   CAPA DE NEGOCIO                           â”‚
â”‚              (Microservicios Backend)                       â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  Servicio        â”‚         â”‚  Servicio        â”‚        â”‚
â”‚  â”‚  Pedidos         â”‚         â”‚  Pagos           â”‚        â”‚
â”‚  â”‚                  â”‚         â”‚  (Inestable)     â”‚        â”‚
â”‚  â”‚  â€¢ CatÃ¡logo      â”‚         â”‚  â€¢ Procesar      â”‚        â”‚
â”‚  â”‚  â€¢ Pedidos       â”‚         â”‚  â€¢ Validar       â”‚        â”‚
â”‚  â”‚  â€¢ Stock         â”‚         â”‚  â€¢ Confirmar     â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   CAPA DE DATOS                             â”‚
â”‚                  (In-Memory Store)                          â”‚
â”‚                  [Educativo - No producciÃ³n]                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**ğŸ’¡ Estos diagramas ilustran visualmente cÃ³mo los patrones de resiliencia  
protegen el sistema y mantienen la disponibilidad ante fallos.**
